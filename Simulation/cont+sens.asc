Version 4
SHEET 1 1980 1272
WIRE -704 112 -736 112
WIRE -592 112 -640 112
WIRE -464 112 -592 112
WIRE -352 112 -464 112
WIRE -736 160 -736 112
WIRE -592 160 -592 112
WIRE -80 192 -80 112
WIRE -464 208 -464 112
WIRE -592 256 -592 240
WIRE -544 256 -592 256
WIRE -528 256 -544 256
WIRE -176 272 -240 272
WIRE -128 272 -176 272
WIRE -864 288 -912 288
WIRE -736 288 -736 240
WIRE -736 288 -800 288
WIRE -592 288 -592 256
WIRE -464 320 -464 304
WIRE -320 320 -320 272
WIRE -320 320 -464 320
WIRE -912 336 -912 288
WIRE -464 336 -464 320
WIRE -320 336 -320 320
WIRE -240 336 -240 272
WIRE -240 336 -256 336
WIRE -736 352 -736 288
WIRE -544 384 -544 256
WIRE -528 384 -544 384
WIRE -352 384 -352 112
WIRE -1040 400 -1040 352
WIRE -752 400 -1040 400
WIRE -592 400 -592 368
WIRE -592 400 -656 400
WIRE -464 464 -464 432
WIRE -1456 480 -1456 416
WIRE -1344 480 -1344 416
WIRE -880 512 -992 512
WIRE -784 512 -880 512
WIRE -352 512 -352 448
WIRE -352 512 -704 512
WIRE -80 512 -80 288
WIRE -80 512 -352 512
WIRE 16 512 -80 512
WIRE 48 512 16 512
WIRE 48 528 48 512
WIRE -880 544 -880 512
WIRE -1456 608 -1456 560
WIRE -1344 608 -1344 560
WIRE -512 656 -672 656
WIRE -880 672 -880 624
WIRE 48 672 48 608
WIRE -512 688 -512 656
WIRE -80 720 -80 512
WIRE -576 736 -592 736
WIRE 608 736 544 736
WIRE 800 736 688 736
WIRE -672 752 -672 656
WIRE 800 768 800 736
WIRE -512 800 -512 784
WIRE -352 800 -352 784
WIRE -352 800 -512 800
WIRE -272 800 -272 784
WIRE -192 800 -272 800
WIRE -128 800 -192 800
WIRE -512 816 -512 800
WIRE -352 848 -352 800
WIRE -336 848 -352 848
WIRE -272 848 -272 800
WIRE -672 864 -672 832
WIRE -592 864 -592 736
WIRE -592 864 -672 864
WIRE -576 864 -592 864
WIRE 544 864 544 736
WIRE -816 880 -992 880
WIRE -80 880 -80 816
WIRE -16 880 -80 880
WIRE 48 880 48 752
WIRE 48 880 -16 880
WIRE 64 880 48 880
WIRE 512 880 448 880
WIRE -672 896 -672 864
WIRE 64 896 64 880
WIRE 160 896 64 896
WIRE 272 896 240 896
WIRE 304 896 272 896
WIRE 640 896 576 896
WIRE 672 896 640 896
WIRE 720 896 672 896
WIRE 800 896 784 896
WIRE 848 896 800 896
WIRE 384 912 384 896
WIRE 512 912 384 912
WIRE -992 928 -992 880
WIRE 64 928 64 896
WIRE 272 928 272 896
WIRE 544 960 544 928
WIRE -816 976 -816 880
WIRE -720 976 -816 976
WIRE 800 976 800 896
WIRE 800 976 720 976
WIRE -672 1008 -672 992
WIRE -512 1008 -512 912
WIRE -512 1008 -672 1008
WIRE 720 1008 720 976
WIRE -512 1024 -512 1008
WIRE 448 1024 448 880
WIRE 528 1024 448 1024
WIRE 672 1024 672 896
WIRE 672 1024 608 1024
WIRE 800 1024 800 976
WIRE -992 1040 -992 1008
WIRE 64 1040 64 1008
WIRE 272 1040 272 992
WIRE 448 1040 448 1024
WIRE 720 1120 720 1088
WIRE 800 1120 800 1088
WIRE 800 1120 720 1120
WIRE 720 1136 720 1120
WIRE 448 1152 448 1120
FLAG -912 336 0
FLAG -880 672 0
FLAG -464 464 0
FLAG -512 1024 0
FLAG 64 1040 0
FLAG -80 112 VDD
FLAG -736 112 VDD
FLAG -512 656 VDD
FLAG -992 512 Vfcontr
FLAG -1344 608 0
FLAG -1456 608 0
FLAG -1456 416 VDD
FLAG -1344 416 PWM
FLAG 16 512 Vout
FLAG -1152 432 0
FLAG -992 1040 0
FLAG -1040 352 PWM
FLAG -192 800 Vfreno
FLAG -16 880 Vsens
FLAG -176 272 Vcont
FLAG 272 1040 0
FLAG 448 1152 0
FLAG 720 1136 0
FLAG 800 768 0
FLAG 544 960 0
FLAG 912 896 Vsens_amp
FLAG 640 896 out_oa
FLAG 800 896 orig_out
SYMBOL res -608 144 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res -608 272 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res -752 144 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res -224 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10
SYMBOL res -688 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 30k
SYMBOL res -864 640 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -656 848 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res -368 800 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 10
SYMBOL res 48 912 R0
SYMATTR InstName R9
SYMATTR Value 0.1
SYMBOL diode -704 128 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL zener -864 304 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N750
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL diode -256 320 R90
WINDOW 0 29 -37 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL diode -272 832 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL nmos -128 192 R0
SYMATTR InstName M1
SYMATTR Value IRFZ44N
SYMBOL nmos -128 720 R0
SYMATTR InstName M2
SYMATTR Value IRFZ44N
SYMBOL npn -576 688 R0
SYMATTR InstName Q1
SYMATTR Value BC547C
SYMBOL npn -528 208 R0
SYMATTR InstName Q2
SYMATTR Value BC547B
SYMBOL pnp -576 912 M180
SYMATTR InstName Q3
SYMATTR Value BC557B
SYMBOL pnp -528 432 M180
SYMATTR InstName Q4
SYMATTR Value BC557B
SYMBOL ind 32 512 R0
SYMATTR InstName L1
SYMATTR Value 10.6m
SYMBOL res 32 656 R0
SYMATTR InstName R10
SYMATTR Value 4.6
SYMBOL voltage -1344 464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -140 194 Left 2
SYMATTR Value PULSE(0 3.3 0 0.00001 0.00001 0.0003 0.0005 100)
SYMATTR InstName V1
SYMBOL voltage -1456 464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 12
SYMBOL nmos -720 896 R0
SYMATTR InstName M3
SYMATTR Value 2N7002
SYMBOL nmos -656 352 R90
SYMATTR InstName M4
SYMATTR Value 2N7002
SYMBOL cap -368 384 R0
SYMATTR InstName C1
SYMATTR Value 47n
SYMBOL voltage -1152 336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL voltage -992 912 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL res 144 912 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL cap 256 928 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL res 288 912 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 432 1024 R0
SYMATTR InstName R13
SYMATTR Value 200
SYMBOL res 624 1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res 704 992 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL cap 784 1024 R0
SYMATTR InstName C3
SYMATTR Value 10µ
SYMBOL cap 912 880 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 2µ
SYMBOL diode 720 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 544 832 R0
SYMATTR InstName U1
SYMATTR Value TL061
SYMBOL voltage 592 736 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 12
TEXT -1472 112 Left 2 !.tran 0 100m 0 100n
TEXT 568 1256 Left 2 !.inc "TL061.mod"
