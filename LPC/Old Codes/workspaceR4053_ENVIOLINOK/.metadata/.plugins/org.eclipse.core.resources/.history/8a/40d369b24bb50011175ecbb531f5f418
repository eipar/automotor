/*
===============================================================================
 PROBLEMA 2.1
 Hacer parpadear un LED en P0.22, con demora por SysTick, utilizando drivers.
 Versi√≥n: 0.0
 Curso: R4054
 Fecha: 06/06/12
 Ing. Ruben M. Lozano
 ===============================================================================
*/

#include <lpc17xx_gpio.h>

/************************** PRIVATE VARIABLES *************************/
 /* SysTick Counter */
 volatile unsigned long SysTickCnt;

 /************************** PRIVATE FUNCTIONS *************************/
 void SysTick_Handler (void);

 void Delay (unsigned long tick);

 /*----------------- INTERRUPT SERVICE ROUTINES --------------------------*/
 /*********************************************************************/
 void SysTick_Handler (void) {
   SysTickCnt++;
 }

 /*-------------------------PRIVATE FUNCTIONS------------------------------*/
 /*********************************************************************/
 void Delay (unsigned long tick) {
   unsigned long systickcnt;

   systickcnt = SysTickCnt;
   while ((SysTickCnt - systickcnt) < tick);
 }


int main(void)
{

	GPIO_SetDir(0, 22 , 1);	//Configuro el pin como salida

	SysTick_Config(SystemCoreClock/1000); /* Generate interrupt each 1 ms   */

	while(1)
		{
		GPIO_SetValue(0, 22);        //coloco un "1" en P0.22
		Delay (2000); // wait 2 seconds (2000ms)

		GPIO_ClearValue(0, 22);        //coloco un "0" en P0.22
		Delay (2000); // wait 2 seconds (2000ms)
		}

	return 0 ;
}

